/*
 * jQuery Lightbox
 * Version 0.5 - 11/29/2007
 * @author Warren Krewenki
 *
 * This package is distributed under the BSD license.
 * For full license information, see LICENSE.TXT
 *
 * Based on Lightbox 2 by Lokesh Dhakar (http://www.huddletogether.com/projects/lightbox2/)
 * Originally written to make use of the Prototype framework, and Script.acalo.us, now altered to use jQuery.
 *
 *
 **/
(function(d){var e=d("a.lightbox:first");var c=e.attr("title");var b=["","Bermuda Break Photo Gallery"];b[0]=c;function a(){e.removeAttr("title");e.attr("title",b[1])}setTimeout(a,200);d.fn.lightbox=function(n){var w=d.extend({},d.fn.lightbox.defaults,n);return this.each(function(){d(this).click(function(){k();if(d(this).hasClass("lightbox")){d(this).removeAttr("title");d(this).attr("title",b[0])}r(this);return false})});function k(){d("#overlay").remove();d("#lightbox").remove();w.inprogress=false;if(w.jsonData&&w.jsonData.length>0){var C=w.jsonDataParser?w.jsonDataParser:d.fn.lightbox.parseJsonData;w.imageArray=[];w.imageArray=C(w.jsonData)}var z='<div id="outerImageContainer"><div id="imageContainer"><iframe id="lightboxIframe" /><img id="lightboxImage"><div id="hoverNav"><a href="javascript://" title="'+w.strings.prevLinkTitle+'" id="prevLink"></a><a href="javascript://" id="nextLink" title="'+w.strings.nextLinkTitle+'"></a></div><div id="loading"><a href="javascript://" id="loadingLink"><img src="'+w.fileLoadingImage+'"></a></div></div></div>';var B='<div id="imageDataContainer" class="clearfix"><div id="imageData"><div id="imageDetails"><span id="caption"></span><span id="numberDisplay"></span></div><div id="bottomNav">';if(w.displayHelp){B+='<span id="helpDisplay">'+w.strings.help+"</span>"}B+='<a href="javascript://" id="bottomNavClose" title="'+w.strings.closeTitle+'"><img src="'+w.fileBottomNavCloseImage+'"></a></div></div></div>';var A;if(w.navbarOnTop){A='<div id="overlay"></div><div id="lightbox">'+B+z+"</div>";d("body").append(A);d("#imageDataContainer").addClass("ontop")}else{A='<div id="overlay"></div><div id="lightbox">'+z+B+"</div>";d("body").append(A)}d("#overlay").click(function(){}).hide();d("#lightbox").click(function(){}).hide();d("#loadingLink").click(function(){return false});d("#bottomNavClose").click(function(){if(c!=b[1]){e.removeAttr("title");e.attr("title",b[1])}p();return false});d("#outerImageContainer").width(w.widthCurrent).height(w.heightCurrent);d("#imageDataContainer").width(w.widthCurrent);if(!w.imageClickClose){d("#lightboxImage").click(function(){return false});d("#hoverNav").click(function(){return false})}}function y(){var z=new Array(d(document).width(),d(document).height(),d(window).width(),d(window).height());return z}function m(){var B,z;if(self.pageYOffset){z=self.pageYOffset;B=self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollTop){z=document.documentElement.scrollTop;B=document.documentElement.scrollLeft}else{if(document.body){z=document.body.scrollTop;B=document.body.scrollLeft}}}var A=new Array(B,z);return A}function s(B){var A=new Date();var z=null;do{z=new Date()}while(z-A<B)}function r(D){d("select, embed, object").hide();var A=y();d("#overlay").hide().css({width:"100%",height:A[1]+"px",opacity:w.overlayOpacity}).fadeIn();imageNum=0;if(!w.jsonData){w.imageArray=[];if(!D.rel||(D.rel=="")){w.imageArray.push(new Array(D.href,w.displayTitle?D.title:""))}else{d("a").each(function(){if(this.href&&(this.rel==D.rel)){w.imageArray.push(new Array(this.href,w.displayTitle?this.title:""))}})}}if(w.imageArray.length>1){for(i=0;i<w.imageArray.length;i++){for(j=w.imageArray.length-1;j>i;j--){if(w.imageArray[i][0]==w.imageArray[j][0]){w.imageArray.splice(j,1)}}}while(w.imageArray[imageNum][0]!=D.href){imageNum++}}var z=m();var C=z[1]+(A[3]/10);var B=z[0];d("#lightbox").css({top:C+"px",left:B+"px"}).show();if(!w.slideNavBar){d("#imageData").hide()}x(imageNum)}function x(z){if(w.inprogress==false){w.inprogress=true;w.activeImage=z;d("#loading").show();d("#lightboxImage").hide();d("#hoverNav").hide();d("#prevLink").hide();d("#nextLink").hide();if(w.slideNavBar){d("#imageDataContainer").hide();d("#imageData").hide();o()}else{o()}}}function o(){imgPreloader=new Image();imgPreloader.onload=function(){var D=imgPreloader.width;var z=imgPreloader.height;if(w.fitToScreen){var B=y();var C;var A=B[2]-2*w.borderSize;var E=B[3]-200;if(imgPreloader.height>E){D=parseInt((E/imgPreloader.height)*imgPreloader.width);z=E}else{if(imgPreloader.width>A){z=parseInt((A/imgPreloader.width)*imgPreloader.height);D=A}}}d("#lightboxImage").attr("src",w.imageArray[w.activeImage][0]).width(D).height(z);q(D,z)};imgPreloader.src=w.imageArray[w.activeImage][0]}function p(){t();d("#lightbox").hide();d("#overlay").fadeOut();d("select, object, embed").show()}function l(){if(w.loopImages&&w.imageArray.length>1){preloadNextImage=new Image();preloadNextImage.src=w.imageArray[(w.activeImage==(w.imageArray.length-1))?0:w.activeImage+1][0];preloadPrevImage=new Image();preloadPrevImage.src=w.imageArray[(w.activeImage==0)?(w.imageArray.length-1):w.activeImage-1][0]}else{if((w.imageArray.length-1)>w.activeImage){preloadNextImage=new Image();preloadNextImage.src=w.imageArray[w.activeImage+1][0]}if(w.activeImage>0){preloadPrevImage=new Image();preloadPrevImage.src=w.imageArray[w.activeImage-1][0]}}}function q(C,A){w.widthCurrent=d("#outerImageContainer").outerWidth();w.heightCurrent=d("#outerImageContainer").outerHeight();var z=Math.max(350,C+(w.borderSize*2));var B=(A+(w.borderSize*2));w.xScale=(z/w.widthCurrent)*100;w.yScale=(B/w.heightCurrent)*100;wDiff=w.widthCurrent-z;hDiff=w.heightCurrent-B;d("#imageDataContainer").animate({width:z},w.resizeSpeed,"linear");d("#outerImageContainer").animate({width:z},w.resizeSpeed,"linear",function(){d("#outerImageContainer").animate({height:B},w.resizeSpeed,"linear",function(){h()})});if((hDiff==0)&&(wDiff==0)){if(jQuery.browser.msie){s(250)}else{s(100)}}d("#prevLink").height(A);d("#nextLink").height(A)}function h(){d("#loading").hide();d("#lightboxImage").fadeIn("fast");g();l();w.inprogress=false}function g(){d("#numberDisplay").html("");if(w.imageArray[w.activeImage][1]){d("#caption").html(w.imageArray[w.activeImage][1]).show()}if(w.imageArray.length>1){var A;A=w.strings.image+(w.activeImage+1)+w.strings.of+w.imageArray.length;if(!w.disableNavbarLinks){if((w.activeImage)>0||w.loopImages){A='<a title="'+w.strings.prevLinkTitle+'" href="#" id="prevLinkText">'+w.strings.prevLinkText+"</a>"+A}if(((w.activeImage+1)<w.imageArray.length)||w.loopImages){A+='<a title="'+w.strings.nextLinkTitle+'" href="#" id="nextLinkText">'+w.strings.nextLinkText+"</a>"}}d("#numberDisplay").html(A).show()}if(w.slideNavBar){d("#imageData").slideDown(w.navBarSlideSpeed)}else{d("#imageData").show()}var z=y();d("#overlay").height(z[1]);u()}function u(){if(w.imageArray.length>1){d("#hoverNav").show();if(w.loopImages){d("#prevLink,#prevLinkText").show().click(function(){x((w.activeImage==0)?(w.imageArray.length-1):w.activeImage-1);return false});d("#nextLink,#nextLinkText").show().click(function(){x((w.activeImage==(w.imageArray.length-1))?0:w.activeImage+1);return false})}else{if(w.activeImage!=0){d("#prevLink,#prevLinkText").show().click(function(){x(w.activeImage-1);return false})}if(w.activeImage!=(w.imageArray.length-1)){d("#nextLink,#nextLinkText").show().click(function(){x(w.activeImage+1);return false})}}f()}}function v(C){var D=C.data.opts;var z=C.keyCode;var A=27;var B=String.fromCharCode(z).toLowerCase();if((B=="x")||(B=="o")||(B=="c")||(z==A)){p()}else{if((B=="p")||(z==37)){if(D.loopImages){t();x((D.activeImage==0)?(D.imageArray.length-1):D.activeImage-1)}else{if(D.activeImage!=0){t();x(D.activeImage-1)}}}else{if((B=="n")||(z==39)){if(w.loopImages){t();x((D.activeImage==(D.imageArray.length-1))?0:D.activeImage+1)}else{if(D.activeImage!=(D.imageArray.length-1)){t();x(D.activeImage+1)}}}}}}function f(){d(document).bind("keydown",{opts:w},v)}function t(){d(document).unbind("keydown")}};d.fn.lightbox.parseJsonData=function(g){var f=[];d.each(g,function(){f.push(new Array(this.url,this.title))});return f};d.fn.lightbox.defaults={fileLoadingImage:"images/common/jquery-lightbox-0.5/loading.gif",fileBottomNavCloseImage:"images/common/jquery-lightbox-0.5/closelabel.gif",overlayOpacity:0.8,borderSize:10,imageArray:new Array,activeImage:null,inprogress:false,resizeSpeed:350,widthCurrent:250,heightCurrent:250,xScale:1,yScale:1,displayTitle:true,navbarOnTop:false,slideNavBar:false,navBarSlideSpeed:350,displayHelp:false,strings:{help:" \u2190 / P - previous image\u00a0\u00a0\u00a0\u00a0\u2192 / N - next image\u00a0\u00a0\u00a0\u00a0ESC / X - close image gallery",prevLinkTitle:"previous image",nextLinkTitle:"next image",prevLinkText:"&laquo; Previous",nextLinkText:"Next &raquo;",closeTitle:"close image gallery",image:"Image ",of:" of "},fitToScreen:true,disableNavbarLinks:false,loopImages:false,imageClickClose:true,jsonData:null,jsonDataParser:null}})(jQuery);