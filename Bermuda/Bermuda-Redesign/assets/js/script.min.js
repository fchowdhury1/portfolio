/*!
 * BermudaTourism.com namespace, includes all common and landing page functionality.
 * @author Chris Kennedy
 * @author Fahim Chowdhury
 */
Bermuda={};Bermuda.Common={elements:{sLink:$("a.select-all"),dsLink:$("a.deselect-all"),bbLink:$(".lightbox"),emailIframeHeader:$("#ifrmemailPopup"),emailIframeFooter:$("#ifrmemailPopupFooter")},initialize:function(){var c=this;var a=/\.(zip|exe|pdf|doc*|xls*|ppt*|mp3)$/i;var b="";if($("base").attr("href")!=undefined){b=$("base").attr("href")}$("a").each(function(){var d=$(this).attr("href");if(d&&(d.match(/^https?\:/i))&&(!d.match(document.domain))){$(this).click(function(){var e=d.replace(/^https?\:\/\//i,"");_gaq.push(["_trackEvent","Outbound-Links","Click-Website-Links",e]);if($(this).attr("target")!=undefined&&$(this).attr("target").toLowerCase()!="_blank"){setTimeout(function(){location.href=d},200);return false}})}else{if(d&&d.match(/^mailto\:/i)){$(this).click(function(){var e=d.replace(/^mailto\:/i,"");_gaq.push(["_trackEvent","Email-Links","Click-MailTo",e])})}else{if(d&&d.match(a)){$(this).click(function(){var f=(/[.]/.exec(d))?/[^.]+$/.exec(d):undefined;var e=d;_gaq.push(["_trackEvent","Downloads","Click-"+f,e]);if($(this).attr("target")!=undefined&&$(this).attr("target").toLowerCase()!="_blank"){setTimeout(function(){location.href=b+d},200);return false}})}}}});c.elements.bbLink.lightbox();$("table.stripes tbody tr:nth-child(odd)").addClass("odd");$("table.stripes tbody tr:nth-child(even)").addClass("even");$(".acco-loc-right > *").hover(function(){return false});$.fn.center=function(){this.css("position","absolute");this.css("top",($(window).height()-this.outerHeight())/2+$(window).scrollTop()+"px");this.css("left",($(window).width()-this.outerWidth())/2+$(window).scrollLeft()+"px");return this};$.fn.center();c.elements.sLink.bind("click",function(f){f.preventDefault();var g=$(this).parent().parent();var d=g.find("ul li input:checkbox");d.each(function(){$(this).attr("checked","checked")})});c.elements.dsLink.bind("click",function(f){f.preventDefault();var g=$(this).parent().parent();var d=g.find("ul li input:checkbox");d.each(function(){$(this).removeAttr("checked")})});if($(".emailprintshare")){$(".emailprintshare a.email").click(function(d){d.preventDefault();$(".email-popup").show();$(".email-popup-footer").hide();return false});$(".emailsignup div a.btn-signup").click(function(d){d.preventDefault();$(".email-popup-footer").show();$(".email-popup").hide();return false});$(".email-popup a.btn-close").bind("click",function(d){d.preventDefault();c.elements.emailIframeHeader.attr("src","/emailsignup.aspx");c.elements.emailIframeHeader.load();$(".email-popup").hide();return false});$(".email-popup-footer a.btn-close").bind("click",function(d){d.preventDefault();c.elements.emailIframeFooter.attr("src","/emailsignup.aspx");c.elements.emailIframeFooter.load();$(".email-popup-footer").hide();return false});$(".emailprintshare a.print").click(function(d){d.preventDefault();window.print();return false})}},toggleTabs:function(e,d,b,c){var a=e;if(c==false){$(a+" .default-state").show()}else{$(a+" .default-state").hide();$(a+" ul.tabs li:first").addClass("active").show();$(a+" .tab-content:first").show()}b.click(function(g){g.preventDefault();d.addClass("hidden");$(a+" .default-state").hide();b.removeClass("active");$(this).addClass("active");var f=$(this).find("a").attr("href");$(f).removeClass("hidden");if(".aboutbermuda-mediagallery"){$(f).removeClass("video-hide")}return false})},toggleCustomTabs:function(e,d,b){var a=e;var c=$("div.tab-content");b.click(function(f){f.preventDefault();b.removeClass("active");$(this).addClass("active");if($(this).hasClass("info")){c.each(function(){$(this).addClass("hidden")});$("div.tab1").removeClass("hidden")}if($(this).hasClass("photogallery")){c.each(function(){$(this).addClass("hidden")});$("div.tab2").removeClass("hidden")}if($(this).hasClass("meetings")){c.each(function(){$(this).addClass("hidden")});$("div.tab3").removeClass("hidden")}if($(this).hasClass("weddings")){c.each(function(){$(this).addClass("hidden")});$("div.tab4").removeClass("hidden")}if($(this).hasClass("offers")){c.each(function(){$(this).addClass("hidden")});$("div.tab5").removeClass("hidden")}return false})}};Bermuda.Homepage={elements:{hDiv:$(".hero-img-carousel"),hPag:".hero-pagination",lpDiv:$(".left-promo-carousel"),lpPag:".left-promo-pagination",bkPop:$(".bookingpopup")},initialize:function(){var c=this;if($("body").hasClass("homepage")){c.elements.hDiv.cycle({fx:"fade",speed:400,timeout:12000,pager:c.elements.hPag});c.elements.lpDiv.cycle({fx:"scrollLeft",speed:600,timeout:5000,pager:c.elements.lpPag,pagerAnchorBuilder:function(d,e){return"<a href='#'>&nbsp;</a>"}});function a(){c.elements.bkPop.fadeIn(800);return}function b(){c.elements.bkPop.fadeOut(800);return}setTimeout(a,4000);setTimeout(b,15000)}}};Bermuda.Navmenu={initialize:function(){var h=500;var e=0;var a=0;var g;function d(){b();c();a=$(this).find("ul").css("visibility","visible");g=$(this).find("div").css("visibility","visible")}function c(){if(a){a.css("visibility","hidden");g.css("visibility","hidden")}}function f(){e=window.setTimeout(c,h)}function b(){if(e){window.clearTimeout(e);e=null}}$(document).ready(function(){$(".topnav > li").bind("mouseover",d);$(".topnav > li").bind("mouseout",f)});document.onclick=c}};Bermuda.BookingWidget={elements:{bytLink:$("li.bookyourtrip a"),bkPop:$(".bookingpopup"),tabParentDiv:"#bookingwidget",tabConDiv:$("#bookingwidget .tab-content"),tabTitLi:$("#bookingwidget ul.tabs li"),bkwidgetIframe:$("#bkwidget")},initialize:function(){var e=this;$("li.bookyourtrip").click(function(){$("#bkwidget").contents().find("ul.tabs li").removeClass("active");$("#bkwidget").contents().find(".vacpack").addClass("active");$("#bkwidget").contents().find("#tab1").removeClass("hidden");e.elements.bytLink.addClass("selected");e.elements.bkPop.fadeIn("fast");return false});$(".bookingpopup a.btn-close").click(function(){e.elements.bytLink.removeClass("selected");e.elements.bkPop.fadeOut("fast");var g=window.location;var f=g.toString().search("gotobermuda.co.uk");if(f!=-1){e.elements.bkwidgetIframe.attr("src","BermudaWidgets/bookingwidget-uk.html")}else{e.elements.bkwidgetIframe.attr("src","BermudaWidgets/bookingwidget.html")}e.elements.bkwidgetIframe.load();return false});Bermuda.Common.toggleTabs(e.elements.tabParentDiv,e.elements.tabConDiv,e.elements.tabTitLi,true);var b=$("a.btn-calendar");b.each(function(){$(this).click(function(f){f.preventDefault()})});var a=new Date();var d=a.getMonth()+1;var c=a.getFullYear();$("select.deptMonth option").each(function(){var f=$(this).val();var g=f.split(/\s*-\s*/);if(g[1]<c){$(this).remove()}if((g[0]<d)&&(g[1]==c)){$(this).remove()}})}};Bermuda.WheretoStay={elements:{whatisthisPop:$(".whatisthisdiv"),tabParentDiv:".wheretostay-property",tabConDiv:$(".wheretostay-property .tab-content"),tabTitLi:$(".wheretostay-property ul.tabs li"),facilitiesPhotoLink:$(".facilities-lightbox"),roomsPhotoLink:$(".rooms-lightbox")},initialize:function(){var a=this;$(".property-information a.lnk-whatisthis").click(function(){a.elements.whatisthisPop.fadeIn("fast");return false});$(".wheretostay-property .property-detail-container .prop-detail .whatisthisdiv a.btn-close").click(function(){a.elements.whatisthisPop.fadeOut("fast");return false});Bermuda.Common.toggleCustomTabs(a.elements.tabParentDiv,a.elements.tabConDiv,a.elements.tabTitLi);a.elements.facilitiesPhotoLink.lightbox();a.elements.roomsPhotoLink.lightbox()}};Bermuda.TravelDeal={elements:{tabParentDiv:".vtab-container",tabConDiv:$(".vtab-container .tab-content"),tabTitLi:$(".vtab-container ul.tabs li"),tabConDivAtag:$(".vtab-container .tab-content a")},initialize:function(){var a=this;Bermuda.Common.toggleTabs(a.elements.tabParentDiv,a.elements.tabConDiv,a.elements.tabTitLi,false);a.elements.tabTitLi.each(function(){var d,c,b,e;d=$(this).text();c=d.split("$");b=c[0].replace(/\s+/g,"-").toLowerCase();$(this).click(function(){_gaq.push(["_trackEvent","hotel-links","hotel-details",b])})})}};Bermuda.AboutBermuda={elements:{tabParentDiv:".aboutbermuda-mediagallery",tabConDiv:$(".aboutbermuda-mediagallery .tab-content"),tabTitLi:$(".aboutbermuda-mediagallery ul.tabs li"),bermudaPhotoLink:$(".bermuda-lightbox"),activityPhotoLink:$(".activity-lightbox"),golfPhotoLink:$(".golf-lightbox"),beachesPhotoLink:$(".beaches-lightbox"),sightPhotoLink:$(".sight-lightbox"),weddingPhotoLink:$(".wedding-lightbox")},initialize:function(){var a=this;Bermuda.Common.toggleTabs(a.elements.tabParentDiv,a.elements.tabConDiv,a.elements.tabTitLi,true);a.elements.bermudaPhotoLink.lightbox();a.elements.activityPhotoLink.lightbox();a.elements.golfPhotoLink.lightbox();a.elements.beachesPhotoLink.lightbox();a.elements.sightPhotoLink.lightbox();a.elements.weddingPhotoLink.lightbox()}};Bermuda.Gethere={elements:{sStatesTp:$("#ctl00_conphMain_ctl01_sStates_tp"),sProTypeTp:$("#ctl00_conphMain_ctl01_sProType_tp"),rfpIframe:$("#formiframe")},initialize:function(){var f=this;var c=$("div.gray-bg");var b=$("body").width();var a=$("body").height();$(".btn-brobanner").click(function(){f.elements.rfpIframe.addClass("formheight");$(".rfp-form-popup").center().show();return false});$("a.btn-brobanner").bind("click",function(g){g.preventDefault();c.css({display:"block",width:b,height:a})});$(".rfp-form-popup a.btn-close").bind("click",function(g){g.preventDefault();f.elements.rfpIframe.attr("src","t12-rfpform.aspx");f.elements.rfpIframe.load();c.css("display","none");$(".rfp-form-popup .form-thankyou").addClass("hidden");$("#formiframe",top.document).height("");$(".rfp-form-popup").hide()});$(".officialrules").click(function(){$(".officialRules-box").center().removeClass("hidden").show();return false});$("a.officialrules").bind("click",function(g){g.preventDefault();c.css({display:"block",width:b,height:a})});$(".officialRules-box a.btn-close").bind("click",function(g){g.preventDefault();c.css("display","none");$(".officialRules-box").hide()});$(".sCountry").change(function(){var g="";$(this).click(function(){g=$(this).val();switch(g){case"0":$(".allstates").hide();break;case"United States":$(".allstates").hide();$(".usstates").show();break;case"Canada":$(".allstates").hide();$(".canstates").show();break;default:$(".allstates").hide();$(".province").show()}})});$(".form-popup a.btn-submit").click(function(g){g.preventDefault();$("#formiframe",top.document).height(250);$(".formcontent").hide();$(".form-thankyou").removeClass("hidden");return false});if($(".content-travelagent")){var e=$("a.s-all");var d=$("a.ds-all");e.click(function(){$(this).addClass("gray");d.removeClass("gray");d.addClass("pink")});d.click(function(){$(this).addClass("gray");e.removeClass("gray");e.addClass("pink")})}}};Bermuda.Footer={initialize:function(){$(".ministermsg a.readMsg").click(function(){$(".ministermsg-popup").show();return false});$(".ministermsg-popup a.btn-close").click(function(){$(".ministermsg-popup").hide();return false})}};$(function(){Bermuda.Common.initialize();Bermuda.Homepage.initialize();Bermuda.WheretoStay.initialize();Bermuda.TravelDeal.initialize();Bermuda.Navmenu.initialize();Bermuda.BookingWidget.initialize();Bermuda.AboutBermuda.initialize();Bermuda.Gethere.initialize();Bermuda.Footer.initialize()});
/*
 * Booking Widget functionality
 */
function chkBrowser(){this.ver=navigator.appVersion;this.dom=document.getElementById?1:0;this.ie5=(this.ver.indexOf("MSIE 5")>-1&&this.dom)?1:0;this.ie4=(document.all&&!this.dom)?1:0;this.ns5=(this.dom&&parseInt(this.ver)>=5)?1:0;this.ns4=(document.layers&&!this.dom)?1:0;this.bVer=(this.ie5||this.ie4||this.ns4||this.ns5);return this}bVer=new chkBrowser();ns4=(document.layers)?true:false;ie4=(document.all)?true:false;function AttB(a){if(bVer.ie4){a.style.display=""}}function AttN(a){if(bVer.ie4){a.style.display="none"}}function show(c,a){cLayer=bVer.dom?document.getElementById(c).style:bVer.ie4?document.all[c].style:bVer.ns4?a?document[a].document[c]:document[c]:0;cLayer.display="";var b=document.getElementById("Wiz")}function hide(b,a){cLayer=bVer.dom?document.getElementById(b).style:bVer.ie4?document.all[b].style:bVer.ns4?a?document[a].document[b]:document[b]:0;cLayer.display="none"}function SetOpts(a){if(a=="2"){hide("pac");hide("hot");hide("car");show("flt");hide("tsh")}else{if(a=="3"){hide("pac");hide("flt");hide("car");show("hot");hide("tsh")}else{if(a=="4"){hide("pac");hide("hot");hide("flt");show("car");hide("tsh")}else{if(a=="5"){hide("car");hide("hot");hide("flt");hide("pac");show("tsh")}else{hide("car");hide("hot");hide("flt");show("pac");hide("tsh")}}}}}function mrd(a){if(a==1){hide("hotrm2");hide("hotrm3")}if(a==2){show("hotrm2");hide("hotrm3")}if(a==3){show("hotrm2");show("hotrm3")}}function SyncVals(b){var a=b.form.name+"."+b.name;d=document.forms;if(a=="CarForm.PickUpLoc"||a=="FltForm.ToAirport"){d.CarForm.PickUpLoc.value=d.FltForm.ToAirport.value=b.value}else{if(a=="FltForm.FromDate"||a=="CarForm.FromDate"){d.FltForm.FromDate.value=d.CarForm.FromDate.value=b.value}else{if(a=="FltForm.ToDate"||a=="CarForm.ToDate"){d.FltForm.ToDate.value=d.CarForm.ToDate.value=b.value}else{if(a=="PkgFormWithFlight.FrAirport"||a=="FltForm.FrAirport"){d.FltForm.FrAirport.value=b.value}else{if(a=="FltForm.NumAdult"){d.FltForm.NumAdult.value=b.value}else{if(a=="FltForm.NumChild"){d.FltForm.NumChild.value=b.value}else{if(a=="FltForm.NumSenior"){d.FltForm.NumSenior.value=b.value}else{if(a=="FltForm.FromTime"||a=="CarForm.PickUpTime"){d.FltForm.FromTime.value=d.CarForm.PickUpTime.value=b.value}else{if(a=="FltForm.ToTime"||a=="CarForm.DropTime"){d.FltForm.ToTime.value=d.CarForm.DropTime.value=b.value}}}}}}}}}}function SetPkgType(a){var b=0;if(3==a){hide("PkgWithFlight");hide("PkgWithFlightCar");show("PkgNoFlight")}else{if(5==a){hide("PkgWithFlight");hide("PkgNoFlight");show("PkgWithFlightCar")}else{hide("PkgNoFlight");hide("PkgWithFlightCar");show("PkgWithFlight");document.getElementById("PkgFormWithFlight").PackageType.value=a}}document.PkgTypeFrm.PrevPkgType.value=a}function switchFlightMode(a){if(document.getElementById("flightReturn")){var b=document.getElementById("flightReturn")}if(b){if(a=="return"){b.style.display=""}else{b.style.display="none"}}}function setMenu(b){if(b<=5){for(i=1;i<6;i++){try{if(i==b){document.getElementById("td"+i).className="bgColor";SetOpts(i);document.getElementById("r"+i).checked=true}else{document.getElementById("td"+i).className="litebgColor"}}catch(a){}}}}function isVisible(e){var c;var a=true;while(a==true){e=e.parentNode;try{c=e.style.display;if(c=="none"){a=false;break}}catch(b){break}}return a}function deleteSingleRadio(){var b;var a;for(var c=0;c<document.getElementsByTagName("input").length;c++){a=document.getElementsByTagName("input")[c];if(a.type=="radio"){if(isVisible(a)){if(b!=null){b=null;break}else{b=a}}}}if(b!=null){b.parentNode.removeChild(b)}}function init(e){var b=new Date(new Date().valueOf()+1814400000);var a=new Date(new Date().valueOf()+1987200000);switch(e){case"30001":var c=(b.getMonth()+1)+"/"+b.getDate()+"/"+b.getFullYear()+"";var f=(a.getMonth()+1)+"/"+a.getDate()+"/"+a.getFullYear()+"";break;case"30009":var c=b.getFullYear()+"/"+(b.getMonth()+1)+"/"+b.getDate()+"";var f=a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate()+"";break;default:var c=b.getDate()+"/"+(b.getMonth()+1)+"/"+b.getFullYear()+"";var f=a.getDate()+"/"+(a.getMonth()+1)+"/"+a.getFullYear()+""}d=document.forms;d.PkgFormWithFlight.FromDate.value=d.PkgFormNoFlight.FromDate.value=d.PkgFormWithFlightCar.FromDate.value=d.TshopsForm.StartDate.value=d.FltForm.FromDate.value=d.CarForm.FromDate.value=d.HotForm.InDate.value=c;d.PkgFormWithFlight.ToDate.value=d.PkgFormNoFlight.ToDate.value=d.PkgFormWithFlightCar.ToDate.value=d.TshopsForm.EndDate.value=d.FltForm.ToDate.value=d.CarForm.ToDate.value=d.HotForm.OutDate.value=f;setMenu("5");setMenu("4");setMenu("3");setMenu("2");setMenu("1");deleteSingleRadio()};
/*
 * Calendar functionality (Booking Widget)
 */
var cF=null;var cW=null;var g_tid=0;var g_cP,g_eD,g_eDP,g_dmin,g_dmax;var nextFocus;var g_fNoCal=false;function getEventObj(a){if(!a){a=window.event}return a}function stopBubble(a){a=getEventObj(a);a.cancelBubble=true;if(a.stopPropagation){a.stopPropagation()}}function CB(){stopBubble(event)}function SCal(d,b,c,a,e){clearTimeout(g_tid);if(g_fNoCal){g_fNoCal=false;return}if(g_calShown&&b==g_eD){return}g_calShown=true;g_calCB=null;g_cP=d;g_eD=b;g_eDP=c;g_dmin=a;g_dmax=e;WaitCal()}function CancelCal(){clearTimeout(g_tid);if(!cF){cF=getObj("CalFrame")}else{cF.style.display="none"}g_calShown=false}function WaitCal(){if(!cW){cW=frames.CalFrame}if(null==cW||null==cW.g_fCL||false==cW.g_fCL){g_tid=setTimeout("WaitCal()",200)}else{if(!cF){cF=getObj("CalFrame")}cF.style.display="none";setTimeout("DoCal()",1)}}function DoCal(){PosCal(g_cP);if(!cW){cW=frames.CalFrame}cW.DoCal(g_eD,g_eDP,g_dmin,g_dmax)}function getScrollTop(){if(document.documentElement.scrollTop){return document.documentElement.scrollTop-400}if(document.body.scrollTop){return document.body.scrollTop-400}if(window.pageYOffset){return window.pageYOffset-400}return 0}function getWinHeight(){if(window.innerHeight){return window.innerHeight-400}if(document.documentElement.clientHeight){return document.documentElement.clientHeight-400}if(document.body.clientHeight){return document.body.clientHeight-400}return 0}function PosCal(f){var a=document.body;var c=0;var e=0;if(!cF){cF=getObj("CalFrame")}for(var h=f;h&&h.tagName!="BODY";h=h.offsetParent){c+=h.offsetLeft;e+=h.offsetTop}var g=f.offsetHeight;var d=parseInt(cF.style.height);var b=getScrollTop();if(e-d>=b&&e+g+d>getWinHeight()+b){e-=d}else{e+=g}cF.style.left=c;cF.style.top=e}function SetNextFocus(a){nextFocus=a;if(nextFocus){nextFocus.onfocus=CancelCal}}function SetPrevFocus(a){if(a){a.onfocus=CancelCal}}function FGoNextFocus(){if(nextFocus){nextFocus.focus();return true}return false}function CalSetFocus(a){if(a){g_fNoCal=true;a.focus();setTimeout("EndCalFocus()",200)}}function EndCalFocus(){g_fNoCal=false}function CalDateSet(e,f,a,h,g){var c=GetDateSep();var b=GetDateFmt();if(b=="mmddyy"){e.value=a+c+f+c+h}else{if(b=="ddmmyy"){e.value=f+c+a+c+h}else{e.value=h+c+a+c+f}}if(!g){CalSetFocus(e)}}var g_calShown=false;function SetCalShown(a){g_calShown=a}var g_calCB;function CalendarCallback(){if(g_calCB){g_calCB()}}function SetCalendarCallback(a){g_calCB=a}function GetInputDate(e){if(!e.length){return null}e=e.replace(/\s+/g,"");if(e.match(/[^-|\d|\.|\/]/)){return null}var f=e.split(/-|\.|\//);for(var c=0;c<f.length;c++){f[c]=parseInt(f[c],10)}if(!f[1]){return null}var a,g,h;var b=GetDateFmt();if(b=="yymmdd"){if(!f[2]){return null}a=f[1];g=f[2];h=f[0]}else{if(b=="mmddyy"){a=f[0];g=f[1]}else{a=f[1];g=f[0]}if(f[2]){h=f[2]}else{h=DefYr(a-1,g)}}a-=1;if(h<100){h+=2000}if(h<1601||h>4500||a<0||a>11||g<1||g>GetMonthCount(a,h)){return null}return new Date(h,a,g)}var rM=new Array(12);rM[0]=rM[2]=rM[4]=rM[6]=rM[7]=rM[9]=rM[11]=31;rM[3]=rM[5]=rM[8]=rM[10]=30;rM[1]=28;function GetMonthCount(a,d){var b=rM[a];if((1==a)&&IsLY(d)){b++}return b}function IsLY(a){if(0==a%4&&((a%100!=0)||(a%400==0))){return true}else{return false}}function DefYr(a,e){var b=new Date();var c=(b.getYear()<1000)?1900+b.getYear():b.getYear();if(a<b.getMonth()||(a==b.getMonth()&&e<b.getDate())){c++}return c}function GetDowStart(){return 1}function GetDateFmt(){var a=window.location;var b=a.toString().search("dev.gotobermuda.co.uk");if(b!=-1){return"ddmmyy"}else{return"mmddyy"}}function GetDateSep(){return"/"}var curDate=new Date();var startDate=(curDate.getMonth()+1)+"/"+curDate.getDate()+"/"+curDate.getFullYear();var endDate=(curDate.getMonth()+1)+"/"+curDate.getDate()+"/"+(curDate.getFullYear()+1);function ShowCalendar(a,c,d,b,e){SCal(a,c,d,startDate,endDate)}function ShowCalSimp(d,b,c,a,e){if(!a){a=""}if(!e){e=""}if(d){SetNextFocus(objNext(d,b));SetPrevFocus(objPrev(d,b))}SCal(b,b,c,a,e)}function objNext(e,g){var c=false,b=e.elements,a=0;for(;a<b.length;a++){if("hidden"!=b[a].type&&false==b[a].disabled&&IsVis(b[a])&&c){return b[a]}if(g.id==b[a].id){c=true}}return null}function objPrev(e,g){var c=false,b=e.elements,a=b.length-1;for(;a>=0;a--){if("hidden"!=b[a].type&&false==b[a].disabled&&IsVis(b[a])&&c){return b[a]}if(g.id==b[a].id){c=true}}return null}function getObj(a){if(document.getElementById){return document.getElementById(a)}else{if(document.all){return document.all[a]}else{if(document.layers){return document.layers[a]}}}}function IsVis(a){if(!a||a.type=="hidden"){return false}while(a&&a.style&&a.style.display!="none"){a=a.parentNode}return !a||!a.style}if(document.documentElement&&document.documentElement.offsetHeight){document.documentElement.onclick=CancelCal}else{document.onclick=CancelCal};